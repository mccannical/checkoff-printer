version: '3.8'

services:
  web:
    build: .
    ports:
      - "8080:8080"
    environment:
      - PRINTER_MODE=mock  # Change to 'mqtt' for MQTT mode, 'usb' for direct USB
      - MQTT_BROKER_HOST=192.168.50.211
      - MQTT_BROKER_PORT=1883
      - MQTT_BROKER_USER=printer
      - MQTT_BROKER_PASS=printer
      - MQTT_PRINTERS=jesse-printer:Jesse,kitchen-huxley:Kitchen
    # USB Passthrough for Linux/Pi
    # This might need adjustment depending on the exact OS and Docker version
    # "priviliged: true" is often the easiest way for hardware access on Pi
    privileged: true
    devices:
      - "/dev/bus/usb:/dev/bus/usb"
    restart: unless-stopped
